<apex:page controller="ZipSnapMetaModelCtl" action="{!getAllSFDCObjects}">
   
   <apex:pageMessages />
   
   <style> 
       .even{
       background-color: rgb(240,240,240);  /* Even row color - Light Grey */
       }
       .odd{
       background-color: rgb(255,255,255);  /* Odd row color - White */
       } 
       .tableHeader{
       background-color: rgb(182,182,182);  /* Dark Grey */
       text-align: center;
       font-family: 'Verdana';
       font-size: 8pt; 
       font-weight: bold;
       }
       .columnFontCenter{
       text-align : center; 
       font-family: 'Verdana';
       font-size: 8pt;
       }
       .columnFontLeft{
       text-align : left; 
       font-family: 'Verdana';
       font-size: 8pt;
       padding: 2px;
       }
       .generalNormal{  
       font-family: 'Verdana';
       font-size: 8pt;
       }
       .generalBold{                
       font-family: 'Verdana';      /* General style for Button */
       font-size: 8pt;
       font-weight: bold;
       }
       .fldCategory{  
       font-family: 'Verdana';
       font-size: 9pt;
       }
       .statusStyle{  
       font-family: 'Verdana';
       font-size: 8pt;
       color: rgb(170,170,170);
       vertical-align: top;
       }
       .batchLabelStyle{  
       font-family: 'Verdana';
       font-size: 8pt;
       color: rgb(0,64,128);
       vertical-align: top;
       }
   </style>
    
  <apex:sectionHeader id="header" title="SnapIt Metadata Xplorer"/>
   
  <apex:form styleclass="generalNormal">
   	 <apex:outputPanel id="pnlInput">
        <apex:pageBlock >
        	<apex:pageBlockButtons location="bottom">
        		<apex:commandButton action="{!processSelectedSobjects}" value="Show Metadata" rerender="pnlPoller, pnlDisplaySelectedObjCnt, pnlDisplayProcessedBatchCnt" styleClass="generalBold" status="tableStatus"/>
        	</apex:pageBlockButtons>
        	
            <apex:outputLabel value="Select Object(s):" styleClass="generalBold"/>&nbsp;&nbsp;&nbsp;&nbsp;
            <apex:selectList id="selectObject" value="{!SelectedObjectNameList}" size="10" styleClass="generalNormal" multiselect="true">
                <apex:selectOptions value="{!SFDCObjectList}"/>
            </apex:selectList>&nbsp;&nbsp;
            
            <p>
            <apex:outputLabel value="Select Field Category:" styleClass="generalBold" for="selectCategory"/>
   			<apex:selectRadio id="selectCategory" layout="linedirection" value="{!SelectedFieldCategory}" styleClass="fldCategory">
      			<apex:selectOptions value="{!FieldCategoryLabels}"/>
      		</apex:selectRadio></p>
      		
      		<p> 
      		<apex:outputPanel id="pnlDisplaySelectedObjCnt"> 
		   		 <apex:outputLabel id="lblSlectedObjCnt" value="Selected Object Count: {!SelectedObjCnt}" styleclass="generalBold" rendered="{!IF(IsSelectedObjCntLabelVisible = True, True, False)}"/>
		    </apex:outputPanel></p>
      		
		    <p><apex:outputPanel id="pnlDisplayProcessedBatchCnt"> 
				<apex:outputLabel value="Processing {!MapKey} Of {!BatchMapSize} Batches..." rendered="{!IF(IsPollerEnabled == True, True, False)}" styleclass="batchLabelStyle"/>
		    </apex:outputPanel></p>
        </apex:pageBlock>
      </apex:outputPanel> 
      
      <apex:outputPanel id="pnlPoller">
      	<apex:actionPoller action="{!getAllFields}" enabled="{!IsPollerEnabled}" rerender="pnlDisplayProcessedBatchCnt, pnlDisplayAllDetails, pnlNavigation" interval="5" status="tableStatus"/>
      </apex:outputPanel>
  </apex:form>
   
  <apex:actionStatus id="tableStatus" onstart="document.body.style.cursor='wait';return true;" onStop="document.body.style.cursor='default';return true;" startStyleClass="statusStyle">
      <apex:facet name="start" >                
          <center>
          		<img src="{!URLFOR($Resource.ApiResources, '/ApiCallResources/img/processing2.gif')}"/>&nbsp;PROCESSING... 
          </center>                
      </apex:facet> 
      <apex:facet name="stop"/>
  </apex:actionStatus>
  
  <apex:outputPanel id="pnlDisplayAllDetails"> 
  <apex:form >
  	  <table width="100%">
  	  <tr>
  	  	<td width="50%">  	  	
	  	  	<apex:outputPanel id="pnlNavigation">
			  <div align="left">
				 	<apex:commandLink id="lnkFirst" action="{!getFirstDisplayBatch}" rendered="{!IsFirstLastVisible}" rerender="pnlDisplayAllDetails, pnlNavigation" status="tableStatus" value="First" styleClass="generalNormal"/>&nbsp;
				 	<apex:commandLink id="lnkPrev" action="{!getPreviousDisplayBatch}" rendered="{!IsPreviousVisible}" rerender="pnlDisplayAllDetails, pnlNavigation" status="tableStatus"  value="Previous" styleClass="generalNormal"/>&nbsp;
				 	<apex:commandLink id="lnkNext" action="{!getNextDisplayBatch}"  rendered="{!IsNextVisible}" rerender="pnlDisplayAllDetails, pnlNavigation" status="tableStatus" value="Next" styleClass="generalNormal"/>&nbsp;
				 	<apex:commandLink id="lnkLast" action="{!getLastDisplayBatch}" rendered="{!IsFirstLastVisible}" rerender="pnlDisplayAllDetails, pnlNavigation" status="tableStatus" value="Last" styleClass="generalNormal"/>
			  </div> 
			 </apex:outputPanel>
		</td>
		<td width="50%">
			  <div align="right" class="generalBold">
		  			<apex:commandButton action="{!exportToExcel}" value="Export to Excel" styleClass="generalBold"/>
		  			<apex:commandButton action="{!exportToPdf}" value="Export to PDF" styleClass="generalBold"/>
		  	  </div>
  	  	</td>
  	  </tr>	 
	  </table>
  </apex:form>
  
  <apex:dataTable id="tblDisplayFieldInfo" value="{!DisplaySFDCFieldList}" var="ft" cellspacing="1" rowClasses="odd,even" align="left">    
       <apex:column headerValue="OBJECT" width="20%" dir="LTR" rowspan="1" headerClass="tableHeader" styleClass="columnFontLeft">
           <apex:outputText value="{!ft.SObjectName}"/>
       </apex:column> 
        
       <apex:column headerValue="LABEL" width="20%" dir="LTR" rowspan="1" headerClass="tableHeader" styleClass="columnFontLeft">
           <apex:outputText value="{!ft.FieldLabel}"/>
       </apex:column>
        
       <apex:column headerValue="API NAME" width="20%" dir="LTR" headerClass="tableHeader" styleClass="columnFontLeft">
           <apex:outputText value="{!ft.FieldName}"/>
       </apex:column>
       
       <apex:column headerValue="DATA TYPE" width="20%" dir="LTR" headerClass="tableHeader" styleClass="columnFontLeft">
           <apex:outputText value="{!ft.FieldDataType}"/>
       </apex:column>
       
       <apex:column headerValue="DETAILS" width="20%" dir="LTR" headerClass="tableHeader" styleClass="columnFontLeft">
           <apex:outputText value="{!ft.FieldDetails}"/>
       </apex:column>
 </apex:dataTable> 
 </apex:outputPanel> 
   		
</apex:page>